<!-- Brandon Mark, Qingyang Dai -->
<!DOCTYPE html>
<html lang="en">
<head>
  <title>Assignment 4 - Survey</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <style>
    body,h1,h2,h3,h4,h5,h6 {font-family: "Lato", sans-serif}
    .w3-bar,h1,button {font-family: "Montserrat", sans-serif}
    .fa-anchor,.fa-coffee {font-size:200px}
    .w3-top {background-color: #006633}
    #heading_effect {border: 5px solid; border-color: #006633; box-shadow: 20px 10px;}
  </style>
</head>


<!-- Body Section -->
<body onload="">

<!-- Navbar -->
<div class="w3-top">
  <div class="w3-bar w3-card w3-left-align w3-large">
    <a class="w3-bar-item w3-button w3-hide-medium w3-hide-large w3-right w3-padding-large w3-hover-white w3-large w3-" href="javascript:void(0);" onclick="myFunction()" title="Toggle Navigation Menu"><i class="fa fa-bars"></i></a>
    <a href="./info.html" class="w3-bar-item w3-button w3-hide-small w3-padding-large w3-hover-white">Home</a>
    <a href="./survey.html" class="w3-bar-item w3-button w3-padding-large w3-white">Survey</a>
  </div>

  <!-- Navbar on small screens -->
  <div id="navDemo" class="w3-bar-block w3-white w3-hide w3-hide-large w3-hide-medium w3-large">
    <a href="./info.html" class="w3-bar-item w3-button w3-padding-large">Home</a>
  </div>
</div>

<!-- Header Section -->
<header id="top" class="w3-container w3-light-grey  w3-center" style="padding:128px 16px">
  <div id="heading_effect">
    <h1 class="w3-margin w3-jumbo">Computer Science Department</h1>
    <p class="w3-xlarge">Information Page</p>
  </div>
  <button onclick="document.getElementById('middle').scrollIntoView();" class="w3-button w3-black w3-padding-large w3-large w3-margin-top">Get Started</button>
</header>

<!-- First Grid -->
<div id="middle"  class="w3-row-padding w3-padding-64 w3-container">
  <div class="w3-content">
    <div class="w3-twothird">

      <!-- Survey Section -->
      <h6>If your name is different than the name displayed in the greeting, <a style="color: red" (click)="studentService.resetName()">Click Here</a> to change it.</h6>
      <h1>Campus Visit Feedback</h1>

      <h6 style="color:red">Field with a * are required!</h6>

      <form id="survey" autocomplete="on" #addForm="ngForm" (ngSubmit)="onAddStudent(addForm, data)">
        <label for="studentCode">Student ID:*</label><br>
        <input type="text" id="studentCode" ngModel="" name="studentCode" value="" required><br>
        <label for="name">Name:*</label><br>
        <input type="text" id="name" ngModel="" name="name" value="" required autofocus><br>
        <label for="address">Street Address:*</label><br>
        <input type="text" id="address" ngModel="" name="address" value="" required><br>
        <label for="city">City:*</label><br>
        <input type="text" id="city" ngModel="" name="city" value="" required><br>
        <label for="state">State:*</label><br>
        <input type="text" id="state" ngModel="" name="state" value="" required><br>
        <label for="zipcode">Zip:*</label><br>
        <input type="text" id="zipcode" ngModel="" name="zipcode" value="" required><br>
        <label for="telephone">Telephone Number:*</label><br>
        <input type="number" id="telephone" ngModel="" name="telephone" value="" placeholder="15551234567" required><br>
        <label for="email"></label>E-Mail:*<br>
        <input type="email" id="email" ngModel="" name="email" value="" placeholder="myemail@server.com" required><br>
        <label for="url"></label>URL:<br>
        <input type="url" id="url" ngModel="" name="url" value="" placeholder="https://mysite.com" required><br>
        <label for="dos">Date of Survey:</label><br>
        <input type="date" id="dos" ngModel="" name="dos" value="" required><br>

        <br>

        <label for="liked_most">What did you like most?</label><br>
        <input type="checkbox" id="liked_most_students" name="liked_most" value="students">
        <label for="liked_most_students">students</label><br>
        <input type="checkbox" id="liked_most_location" name="liked_most" value="location">
        <label for="liked_most_location">location</label><br>
        <input type="checkbox" id="liked_most_campus" name="liked_most" value="campus">
        <label for="liked_most_campus">campus</label><br>
        <input type="checkbox" id="liked_most_atmosphere" name="liked_most" value="atmosphere">
        <label for="liked_most_atmosphere">atmosphere</label><br>
        <input type="checkbox" id="liked_most_dorm_rooms" name="liked_most" value="dorm_rooms">
        <label for="liked_most_dorm_rooms">dorm rooms</label><br>
        <input type="checkbox" id="liked_most_sports" name="liked_most" value="sports">
        <label for="liked_most_sports">sports</label><br>

        <br>

        <label for="found_out">How did you find out about us?</label><br>
        <input type="radio" id="found_out_friends" name="found_out" value="friends">
        <label for="found_out_friends">friends</label><br>
        <input type="radio" id="found_out_television" name="found_out" value="television">
        <label for="found_out_television">television</label><br>
        <input type="radio" id="found_out_internet" name="found_out" value="internet">
        <label for="found_out_internet">internet</label><br>
        <input type="radio" id="found_out_other" name="found_out" value="other">
        <label for="found_out_other">other</label><br>

        <br>

        <label for="graduation_date">What is your high-school grudation month?</label><br>
        <input list="graduation_months" id="graduation_date" name="graduation_date"><br>

        <datalist id="graduation_months">
          <option value="January"></option>
          <option value="Febuary"></option>
          <option value="March"></option>
          <option value="April"></option>
          <option value="May"></option>
          <option value="June"></option>
          <option value="July"></option>
          <option value="August"></option>
          <option value="September"></option>
          <option value="October"></option>
          <option value="November"></option>
          <option value="December"></option>
        </datalist>

        <label for="graduation_year">What is your high-school graduation year?</label><br>
        <input type="text" id="graduation_year" name="graduation_year" value=""><br>

        <br>

        <label for="recommend_likelihood">What is the likelihood you would recommend this school to other prospective students?</label><br>
        <select id="recommend_likelihood" name="recommend_likelihood">
          <option value="Very Likely">Very Likely</option>
          <option value="Likely">Likely</option>
          <option value="Unlikely">Unlikely</option>
        </select>

        <br>

        <label for="additional_comments">Additional Comments</label><br>
        <textarea id="additional_comments" name="additional_comments" rows="4" cols="40"></textarea>


        <br>


        <h6 style="color: red;">*Enter 10 comma separated values that are between 1 and 100, inclusive.</h6>
        <label for="data">Enter Data Values:</label><br>
        <textarea id="data" #data name="data" rows="2" cols="20"></textarea>


        <br>


        <input [disabled]="addForm.invalid" id="submit" type="submit" class="w3-button w3-black w3-padding-large w3-large w3-margin-top">
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input id="reset" type="reset" class="w3-button w3-black w3-padding-large w3-large w3-margin-top">
      </form>
    </div>

    <div class="w3-third w3-center">
      <i class="fa fa-anchor w3-padding-64" style="color: #FFCC33"></i><br>
    </div>
  </div>
</div>

<div style="background-color: #006633" class="w3-container w3-center w3-padding-16">
  <button onclick="document.getElementById('top').scrollIntoView();" class="w3-button w3-black w3-padding-medium w3-medium w3-margin-top">Back to Top</button>
</div>

<div id="dialog" title="Status Message">
  <p id="output"></p>
</div>

<!-- Footer Section -->
<footer class="w3-container w3-padding-16 w3-right w3-opacity">
  <div class="w3-xlarge w3-padding-16">
    <img src="https://i1.wp.com/qsecgmu.wpengine.com/wp-content/uploads/MasonM_Grn.png" alt="George Mason University Logo" width="50" height="50">
  </div>
</footer>


<script>
  // Used to toggle the menu on small screens when clicking on the menu button (mobile support!)
  function myFunction() {
    var x = document.getElementById("navDemo");
    if (x.className.indexOf("w3-show") == -1) {
      x.className += " w3-show";
    } else {
      x.className = x.className.replace(" w3-show", "");
    }
  }

  function setCookie(cookie_name, cookie_value, expiration_days)
  {
    const date = new Date();
    date.setTime(date.getTime() + (expiration_days*24*60*60*1000));
    let expiration_date = "expires = " + date.toUTCString();
    document.cookie = cookie_name + "=" + cookie_value + ";" + expiration_date + ";path=/";
  }

  function getCookie(cookie_name)
  {
    let username = cookie_name + "=";
    let decoded_cookie = decodeURIComponent(document.cookie);
    let parts = decoded_cookie.split(';');
    for(let i = 0; i < parts.length; i++)
    {
      let x = parts[i];
      while(x.charAt(0) == ' ')
      {
        x = x.substring(1);
      }
      if(x.indexOf(username) == 0)
      {
        return x.substring(username.length, x.length);
      }
    }
    return "";
  }

  function checkCookie()
  {
    let username = getCookie("username");
    let date = new Date();
    if(username)
    {
      if(date.getHours >= 5 && date.getHours < 12)
      {
        alert("Good Morning " + username + ", welcome to SWE642 Survey");
      }
      else if(date.getHours >= 12 && date.getHours < 6)
      {
        alert("Good Afternoon " + username + ", welcome to SWE642 Survey");
      }
      else
      {
        alert("Good Evening " + username + ", welcome to SWE642 Survey");
      }
    }
    else
    {
      resetName();
    }
  }

  function resetName()
  {
    let username = prompt("Please enter your name:", "");
    while(username === "" || username === null)
    {
      username = prompt("Please enter your name:", "");
    }
    setCookie("username", username, 7);
    location.reload();
  }

  function calculate_average_n_maximum()
  {
    let input = document.getElementById('data').value;
    if(/^\d+(,\d+)*$/.test(input))
    {
      let parts = input.split(',');
      if(parts.length == 10)
      {
        let good_values = true;
        for(let i = 0; i < parts.length; i++)
        {
          if(parseInt(parts[i]) <= 0 || parseInt(parts[i]) > 100)
          {
            good_values = false;
            break;
          }
        }
        if(good_values)
        {
          let sum = 0;
          let max = Number.NEGATIVE_INFINITY;
          for(let i = 0; i < parts.length; i++)
          {
            let x = parseInt(parts[i]);
            sum += x;
            if(x > max)
            {
              max = x;
            }
          }
          document.getElementById('average').value = sum/parts.length;
          document.getElementById('maximum').value = max;
        }
        else
        {
          alert("Data values inputed are not valid, please correct!");
          document.getElementById('average').value = "Error: Values must be between 1-100 (inclusive)!";
          document.getElementById('maximum').value = "Error: Values must be between 1-100 (inclusive)!";
        }

      }
      else
      {
        alert("Data values inputed are not valid, please correct!");
        document.getElementById('average').value = "Error: Must be 10 values comma seperated!";
        document.getElementById('maximum').value = "Error: Must be 10 values comma seperated!";
      }
    }
    else
    {
      alert("Data values inputed are not valid, please correct!");
      document.getElementById('average').value = "Error: Illegal charaters!";
      document.getElementById('maximum').value = "Error: Illegal charaters!";
    }
  }

  function formValidate()
  {
    let name = document.getElementById('name').value;
    let address = document.getElementById('street_address').value;
    let city = document.getElementById('city').value;
    let state = document.getElementById('state').value;
    let zip = document.getElementById('zip').value;
    const checkboxes = [];
    checkboxes[0] = document.getElementById('liked_most_atmosphere').checked;
    checkboxes[1] = document.getElementById('liked_most_campus').checked;
    checkboxes[2] = document.getElementById('liked_most_dorm_rooms').checked;
    checkboxes[3] = document.getElementById('liked_most_location').checked;
    checkboxes[4] = document.getElementById('liked_most_sports').checked;
    checkboxes[5] = document.getElementById('liked_most_students').checked;
    const radiobuttons = [];
    radiobuttons[0] = document.getElementById('found_out_friends').checked;
    radiobuttons[1] = document.getElementById('found_out_internet').checked;
    radiobuttons[2] = document.getElementById('found_out_other').checked;
    radiobuttons[3] = document.getElementById('found_out_television').checked;

    let error = "<ul>";
    if(!/^[a-zA-z]+([\s][a-zA-Z]+)*$/.test(name))
    {
      error += "<li>Error illegal characters: Name can only contain letters!</li>";
    }
    if(!/^[a-zA-z\d]+([\s][a-zA-Z\d]+)*$/.test(address))
    {
      error += "<li>Error illagal characters: Address can only contains numbers and letters!</li>";
    }
    if(!/^[a-zA-z]+([\s][a-zA-Z]+)*$/.test(city))
    {
      error += "<li>Error illegal characters: City can only contain letters!</li>";
    }
    if(!/^[a-zA-z]+([\s][a-zA-Z]+)*$/.test(state))
    {
      error += "<li>Error illegal characters: State can only contain letters!</li>";
    }
    if(!/^[\d]+$/.test(zip))
    {
      error += "<li>Error illegal characters: Zip can only contain numbers!</li>";
    }
    let count_checkboxes = 0, count_radiobuttons = 0, i = checkboxes.length, j = radiobuttons.length;
    while(i >= 0)
    {
      if(checkboxes[i] === false)
      {
        count_checkboxes++;
      }
      i--;
    }
    if(count_checkboxes >= 5)
    {
      error += "<li>Error checkboxes: Must have at least 2 checkboxes checked!</li>";
    }
    while(j >= 0)
    {
      if(radiobuttons[j] === false)
      {
        count_radiobuttons++;
      }
      j--;
    }
    if(count_radiobuttons == 4)
    {
      error += "<li>Error radio buttons: Must have at least 1 radio button selected!</li>";
    }

    if(error === "<ul>")
    {
      document.getElementById("output").innerHTML = "Thanks for submitting the survey!";
      return true;
    }
    else
    {
      error += "</ul>";
      document.getElementById("output").innerHTML = error;
      return false;
    }
  }

</script>

</body>
</html>
